<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evolutivo de Alcance por Asesor - Noviembre</title>
    <style>
        :root {
            --verde-oscuro: #1b5e20;
            --verde-claro: #c8e6c9;
            --amarillo-oscuro: #f57f17;
            --amarillo-claro: #fff9c4;
            --naranja-oscuro: #e65100;
            --naranja-claro: #ffe0b2;
            --rojo-oscuro: #b71c1c;
            --rojo-claro: #ffcdd2;
            --gris: #f5f5f5;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #2c3e50, #4a6491);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .fecha-actualizacion {
            font-size: 1rem;
            margin-top: 10px;
            opacity: 0.9;
        }
        
        .clasificaciones {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .clasificacion {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .clasificacion:hover {
            transform: translateY(-5px);
        }
        
        .clasificacion-header {
            padding: 15px;
            color: white;
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .clasificacion-100 {
            background-color: var(--verde-oscuro);
        }
        
        .clasificacion-70 {
            background-color: var(--amarillo-oscuro);
        }
        
        .clasificacion-40 {
            background-color: var(--naranja-oscuro);
        }
        
        .clasificacion-0 {
            background-color: var(--rojo-oscuro);
        }
        
        .asesores-lista {
            max-height: 400px;
            overflow-y: auto;
            background-color: white;
        }
        
        .asesor-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .asesor-item:last-child {
            border-bottom: none;
        }
        
        .asesor-nombre {
            font-weight: 500;
        }
        
        .asesor-porcentaje {
            font-weight: bold;
            padding: 4px 10px;
            border-radius: 20px;
            color: white;
            font-size: 0.9rem;
        }
        
        .gradiente-100 {
            background: linear-gradient(to right, var(--verde-claro), white);
        }
        
        .gradiente-70 {
            background: linear-gradient(to right, var(--amarillo-claro), white);
        }
        
        .gradiente-40 {
            background: linear-gradient(to right, var(--naranja-claro), white);
        }
        
        .gradiente-0 {
            background: linear-gradient(to right, var(--rojo-claro), white);
        }
        
        .porcentaje-100 {
            background-color: var(--verde-oscuro);
        }
        
        .porcentaje-70 {
            background-color: var(--amarillo-oscuro);
        }
        
        .porcentaje-40 {
            background-color: var(--naranja-oscuro);
        }
        
        .porcentaje-0 {
            background-color: var(--rojo-oscuro);
        }
        
        .estadisticas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }
        
        .estadistica-card {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .estadistica-valor {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .estadistica-100 .estadistica-valor {
            color: var(--verde-oscuro);
        }
        
        .estadistica-70 .estadistica-valor {
            color: var(--amarillo-oscuro);
        }
        
        .estadistica-40 .estadistica-valor {
            color: var(--naranja-oscuro);
        }
        
        .estadistica-0 .estadistica-valor {
            color: var(--rojo-oscuro);
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .clasificaciones {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>EVOLUTIVO DE ALCANCE POR ASESOR - NOVIEMBRE</h1>
            <div class="fecha-actualizacion">Última actualización: <span id="fecha-actual"></span></div>
        </header>
        
        <div class="clasificaciones">
            <!-- Clasificación >100% -->
            <div class="clasificacion">
                <div class="clasificacion-header clasificacion-100">>100%</div>
                <div class="asesores-lista" id="lista-100"></div>
            </div>
            
            <!-- Clasificación >70% -->
            <div class="clasificacion">
                <div class="clasificacion-header clasificacion-70">>70%</div>
                <div class="asesores-lista" id="lista-70"></div>
            </div>
            
            <!-- Clasificación >40% -->
            <div class="clasificacion">
                <div class="clasificacion-header clasificacion-40">>40%</div>
                <div class="asesores-lista" id="lista-40"></div>
            </div>
            
            <!-- Clasificación >0% -->
            <div class="clasificacion">
                <div class="clasificacion-header clasificacion-0">>0%</div>
                <div class="asesores-lista" id="lista-0"></div>
            </div>
        </div>
        
        <div class="estadisticas">
            <div class="estadistica-card estadistica-100">
                <div>Asesores >100%</div>
                <div class="estadistica-valor" id="cantidad-100">0</div>
                <div>Meta superada</div>
            </div>
            
            <div class="estadistica-card estadistica-70">
                <div>Asesores >70%</div>
                <div class="estadistica-valor" id="cantidad-70">0</div>
                <div>Alto rendimiento</div>
            </div>
            
            <div class="estadistica-card estadistica-40">
                <div>Asesores >40%</div>
                <div class="estadistica-valor" id="cantidad-40">0</div>
                <div>Rendimiento medio</div>
            </div>
            
            <div class="estadistica-card estadistica-0">
                <div>Asesores >0%</div>
                <div class="estadistica-valor" id="cantidad-0">0</div>
                <div>Por mejorar</div>
            </div>
        </div>
        
        <footer>
            <p>Sistema de seguimiento de metas - Actualización diaria</p>
        </footer>
    </div>

    <script>
        // Datos de ejemplo (simulando la extracción del Excel)
        const datosAsesores = [
            { nombre: "Ana García", porcentaje: 125, clasificacion: ">100%" },
            { nombre: "Carlos López", porcentaje: 118, clasificacion: ">100%" },
            { nombre: "María Rodríguez", porcentaje: 110, clasificacion: ">100%" },
            { nombre: "Pedro Martínez", porcentaje: 105, clasificacion: ">100%" },
            { nombre: "Laura Sánchez", porcentaje: 98, clasificacion: ">70%" },
            { nombre: "Javier Fernández", porcentaje: 95, clasificacion: ">70%" },
            { nombre: "Sofía Pérez", porcentaje: 87, clasificacion: ">70%" },
            { nombre: "Diego González", porcentaje: 82, clasificacion: ">70%" },
            { nombre: "Elena Ramírez", porcentaje: 79, clasificacion: ">70%" },
            { nombre: "Miguel Torres", porcentaje: 75, clasificacion: ">70%" },
            { nombre: "Isabel Díaz", porcentaje: 68, clasificacion: ">40%" },
            { nombre: "Roberto Silva", porcentaje: 65, clasificacion: ">40%" },
            { nombre: "Carmen Vargas", porcentaje: 58, clasificacion: ">40%" },
            { nombre: "Andrés Herrera", porcentaje: 52, clasificacion: ">40%" },
            { nombre: "Patricia Mora", porcentaje: 47, clasificacion: ">40%" },
            { nombre: "Ricardo Castro", porcentaje: 42, clasificacion: ">40%" },
            { nombre: "Natalia Ríos", porcentaje: 35, clasificacion: ">0%" },
            { nombre: "Fernando Reyes", porcentaje: 28, clasificacion: ">0%" },
            { nombre: "Gabriela Paredes", porcentaje: 22, clasificacion: ">0%" },
            { nombre: "Héctor Medina", porcentaje: 15, clasificacion: ">0%" },
            { nombre: "Verónica Soto", porcentaje: 8, clasificacion: ">0%" },
            { nombre: "Oscar Guzmán", porcentaje: 3, clasificacion: ">0%" }
        ];

        // Función para formatear la fecha actual
        function formatearFecha() {
            const ahora = new Date();
            const opciones = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            return ahora.toLocaleDateString('es-ES', opciones);
        }

        // Función para ordenar asesores por porcentaje (mayor a menor)
        function ordenarAsesores(asesores) {
            return asesores.sort((a, b) => b.porcentaje - a.porcentaje);
        }

        // Función para obtener el nombre de la clase de gradiente según la clasificación
        function obtenerClaseGradiente(clasificacion) {
            switch(clasificacion) {
                case ">100%": return "gradiente-100";
                case ">70%": return "gradiente-70";
                case ">40%": return "gradiente-40";
                case ">0%": return "gradiente-0";
                default: return "";
            }
        }

        // Función para obtener la clase del porcentaje según la clasificación
        function obtenerClasePorcentaje(clasificacion) {
            switch(clasificacion) {
                case ">100%": return "porcentaje-100";
                case ">70%": return "porcentaje-70";
                case ">40%": return "porcentaje-40";
                case ">0%": return "porcentaje-0";
                default: return "";
            }
        }

        // Función para mostrar los asesores en las listas correspondientes
        function mostrarAsesores() {
            const asesoresOrdenados = ordenarAsesores(datosAsesores);
            
            // Inicializar contadores
            const contadores = {
                ">100%": 0,
                ">70%": 0,
                ">40%": 0,
                ">0%": 0
            };
            
            // Mostrar asesores en sus respectivas listas
            asesoresOrdenados.forEach(asesor => {
                const listaId = `lista-${asesor.clasificacion.replace('%', '').replace('>', '')}`;
                const lista = document.getElementById(listaId);
                
                if (lista) {
                    const item = document.createElement('div');
                    item.className = `asesor-item ${obtenerClaseGradiente(asesor.clasificacion)}`;
                    
                    item.innerHTML = `
                        <div class="asesor-nombre">${asesor.nombre}</div>
                        <div class="asesor-porcentaje ${obtenerClasePorcentaje(asesor.clasificacion)}">
                            ${asesor.porcentaje}%
                        </div>
                    `;
                    
                    lista.appendChild(item);
                    contadores[asesor.clasificacion]++;
                }
            });
            
            // Actualizar contadores en las tarjetas de estadísticas
            document.getElementById('cantidad-100').textContent = contadores[">100%"];
            document.getElementById('cantidad-70').textContent = contadores[">70%"];
            document.getElementById('cantidad-40').textContent = contadores[">40%"];
            document.getElementById('cantidad-0').textContent = contadores[">0%"];
        }

        // Inicializar la aplicación
        document.addEventListener('DOMContentLoaded', function() {
            // Establecer fecha de actualización
            document.getElementById('fecha-actual').textContent = formatearFecha();
            
            // Mostrar asesores
            mostrarAsesores();
        });
    </script>
</body>
</html>